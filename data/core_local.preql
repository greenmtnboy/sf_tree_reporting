import raw.tree_info;

# Backward-compatible payload used by the current frontend loader.
copy into json `./raw_data.json` from
where plant_type = 'Tree' and latitude is not null and longitude is not null
SELECT
    tree_id,
    # plant_type,
    common_name,
    site_info,
    plant_date,
    species,
    # q_legal_status,
    latitude,
    longitude,
    diameter_at_breast_height
order by plant_date asc
;

# High-LOD payload with precomputed filter/join fields so the map path can avoid
# runtime normalization and enrichment joins.
copy into json `./raw_data_high_lod.json` from
where plant_type = 'Tree' and latitude is not null and longitude is not null
SELECT
    tree_id,
    common_name,
    site_info,
    plant_date,
    species,
    species as species_key,
    tree_category,
    native_status,
    is_evergreen,
    mature_height_ft,
    bloom_season,
    wildlife_value,
    fire_risk,
    latitude,
    longitude,
    diameter_at_breast_height
order by plant_date asc
;

# Low-LOD payload: same row-grain but narrow columns for cheaper scans and
# faster low-zoom aggregation paths.
copy into json `./raw_data_low_lod.json` from
where plant_type = 'Tree' and latitude is not null and longitude is not null
SELECT
    tree_id,
    species as species_key,
    tree_category,
    latitude,
    longitude,
    diameter_at_breast_height
order by tree_id asc
;